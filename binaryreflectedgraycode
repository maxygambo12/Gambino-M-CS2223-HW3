import java.util.*;
public class Main {
    private static final String[] CHILDREN = {"Alice", "Bob", "Chris", "Dylan", "Eve"};
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        System.out.print("Enter the number of children: ");
        int n = 5;
        if (scanner.hasNextInt()) {
            n = scanner.nextInt();
            if (n < 1 || n > 5) {
                System.out.println("All children");
                n = 5;
            }
        }
        System.out.println("Gray Code of " + n);
        List<String> grayCode = brgc(n);
        generatePhotoTable(grayCode, n);
        System.out.println("MOVEMENT SEQUENCE");
        generateMovementSequence(grayCode, n);
    }

    public static List<String> brgc(int n) {
        List<String> list = new ArrayList<>();
        if (n == 1) {
            list.add("0");
            list.add("1");
        } else {
            List<String> list1 = brgc(n - 1);
            List<String> list2 = new ArrayList<>(list1);
            Collections.reverse(list2);
            for (String code : list1) {
                list.add("0" + code);
            }

            for (String code : list2) {
                list.add("1" + code);
            }
        }
        return list;
    }

    public static void generatePhotoTable(List<String> grayCode, int n) {
        System.out.println("Sequence Table");
        System.out.println("Index    Gray Code   Child/Children in Photo         Action");
        String previousCode = "0".repeat(n);
        for (int i = 0; i < grayCode.size(); i++) {
            String currentCode = grayCode.get(i);
            String childrenInPhoto = getChildrenInPhoto(currentCode, n);
            String action = getAction(previousCode, currentCode, n);
            System.out.println((i + 1) + "   " + currentCode + "   " + (childrenInPhoto.isEmpty() ? "(none)" : childrenInPhoto) + "          " + action);
            previousCode = currentCode;
        }
    }

    public static String getChildrenInPhoto(String code, int n) {
        List<String> children = new ArrayList<>();
        for (int i = 0; i < n; i++) {
            int bitPosition = n - 1 - i;
            if (code.charAt(bitPosition) == '1') {
                children.add(CHILDREN[i]);
            }
        }
        return String.join(" & ", children);
    }

    public static String getAction(String previous, String current, int n) {
        for (int i = 0; i < n; i++) {
            int bitPosition = n - 1 - i;
            if (previous.charAt(bitPosition) != current.charAt(bitPosition)) {
                String childName = CHILDREN[i];
                if (current.charAt(bitPosition) == '1') {
                    return childName + " In";
                } else {
                    return childName + " Out";
                }
            }
        }
        return "No change";
    }

    public static void generateMovementSequence(List<String> grayCode, int n) {
        List<String> movements = new ArrayList<>();
        String previousCode = "0".repeat(n);
        for (String currentCode : grayCode) {
            for (int i = 0; i < n; i++) {
                int bitPosition = n - 1 - i;
                if (previousCode.charAt(bitPosition) != currentCode.charAt(bitPosition)) {
                    movements.add(CHILDREN[i]);
                    break;
                }
            }
            previousCode = currentCode;
        }

        System.out.println("Child movement sequence:");
        System.out.println(String.join(", ", movements));
        System.out.println("First movements: " + String.join(", ", movements.subList(0, Math.min(10, movements.size()))) + ", ...");
        System.out.println("Movements per child:");
        Map<String, Integer> movementCount = new HashMap<>();
        for (String child : movements) {
            movementCount.put(child, movementCount.getOrDefault(child, 0) + 1);
        }
        for (int i = 0; i < n; i++) {
            String child = CHILDREN[i];
            System.out.println(child + ": " + movementCount.getOrDefault(child, 0) + " movements");
        }
    }
}Binary Reflected Gray Code
